"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[474],{9474:function(e,r,n){n.d(r,{E:function(){return ee},r:function(){return _}});var t=n(5893),a=n(7294),i=n(1664),o=n.n(i),l=n(8527),u=n(5193),c=n(7657),s=n(1358),f=n(9762),m=n(4612),d=n(3307),h=n(4051),g=n.n(h),p=n(1163),b=n(7536),y=n(4231),v=n(5496),x=n(7375),j=n(8843),w=n(1153);function I(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function k(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(t=n.next()).done)&&(i.push(t.value),!r||i.length!==r);o=!0);}catch(u){l=!0,a=u}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return I(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var S=function(){var e=(0,a.useState)(""),r=e[0],n=e[1],t=(0,a.useState)(),i=t[0],o=t[1],l=k((0,x.kt)(),2),u=l[0],c=l[1];return{uploadImage:function(e){var r=(0,w.cF)(),n=(0,w.iH)(r,encodeURI(e.name));return(0,w.KV)(n,e).then((function(){return(0,w.Jt)(n)}))},image:r,imageFile:i,handleChangeImage:function(e){if(null!==e.target.files){var r=URL.createObjectURL(e.target.files[0]);n(r),o(e.target.files[0]),c.on()}},isImageChanged:u}};function C(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function O(e,r,n,t,a,i,o){try{var l=e[i](o),u=l.value}catch(c){return void n(c)}l.done?r(u):Promise.resolve(u).then(t,a)}function E(e){return function(){var r=this,n=arguments;return new Promise((function(t,a){var i=e.apply(r,n);function o(e){O(i,t,a,o,l,"next",e)}function l(e){O(i,t,a,o,l,"throw",e)}o(void 0)}))}}function A(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function R(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){A(e,r,n[r])}))}return e}function D(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(t=n.next()).done)&&(i.push(t.value),!r||i.length!==r);o=!0);}catch(u){l=!0,a=u}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return C(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var P=y.Ry({title:y.Z_().required("\u65c5\u306e\u540d\u524d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"),date:y.IX(),links:y.IX().of(y.Ry().shape({url:y.Z_().required("url\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044").matches(/^(https?|ftp)(:\/\/[-_.!~*'()a-zA-Z0-9;/?:@&=+$,%#]+)/,{message:"\u5229\u7528\u53ef\u80fd\u306aURL\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"}),label:y.Z_()}))}),z=n(4480),L=n(7658);function N(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function T(e,r,n,t,a,i,o){try{var l=e[i](o),u=l.value}catch(c){return void n(c)}l.done?r(u):Promise.resolve(u).then(t,a)}function Z(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(t=n.next()).done)&&(i.push(t.value),!r||i.length!==r);o=!0);}catch(u){l=!0,a=u}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return N(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var U=y.Ry({name:y.Z_().required("\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044")}),X=function(e){var r=Z((0,z.FV)(L.f),2),n=r[0],t=r[1],a=(0,p.useRouter)(),i=Z((0,x.kt)(),2),o=i[0],l=i[1],u=(0,b.cI)({resolver:(0,v.X)(U),defaultValues:{name:e.name}}),c=u.register,s=u.handleSubmit,f=u.formState.errors,m=S(),d=m.uploadImage,h=m.image,y=m.imageFile,w=m.handleChangeImage,I=m.isImageChanged,k=j.Io,C=function(){var r,i=(r=g().mark((function r(i){var o,u;return g().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=i,r.prev=1,l.on(),!y||!I){r.next=8;break}return r.next=6,d(y);case 6:u=r.sent,o.icon=u;case 8:return r.next=10,k(o,e.uid);case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(1),console.error(r.t0);case 15:return r.prev=15,"/"===n&&t("/user"),a.push("/home"),l.off(),r.finish(15);case 20:case"end":return r.stop()}}),r,null,[[1,12,15,20]])})),function(){var e=this,n=arguments;return new Promise((function(t,a){var i=r.apply(e,n);function o(e){T(i,t,a,o,l,"next",e)}function l(e){T(i,t,a,o,l,"throw",e)}o(void 0)}))});return function(e){return i.apply(this,arguments)}}();return{register:c,handleSubmit:s,onSubmit:C,errors:f,disabled:o,handleChangeImage:w,image:h,history:n}};function B(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function F(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){B(e,r,n[r])}))}return e}var _=function(e){var r=e.data,n=X(r),i=n.register,h=n.handleSubmit,g=n.onSubmit,p=n.errors,b=n.disabled,y=n.handleChangeImage,v=n.image,x=n.history,j=(0,a.useRef)(null);return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(l.xu,{as:"form",height:"100vh",position:"relative",children:[(0,t.jsxs)(l.kC,{w:"100%",h:"6.3rem",justify:"center",align:"center",children:["/"!==x&&(0,t.jsx)(o(),{href:"/home",passHref:!0,children:(0,t.jsx)(u.hU,{"aria-label":"return",size:"lg",icon:(0,t.jsx)(d.BK,{w:"2.2rem",h:"2.2rem"})})}),(0,t.jsx)(l.LZ,{}),(0,t.jsx)(l.xu,{color:"black",fontSize:"md",fontWeight:"bold",children:"\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb"}),(0,t.jsx)(l.LZ,{}),(0,t.jsx)(l.xu,{w:"2.2rem",h:"2.2rem"})]}),(0,t.jsx)(l.kC,{align:"center",justify:"center",children:(0,t.jsx)(l.xu,{borderRadius:"50%",filter:"drop-shadow(4px 4px 10px #E4EBEE);",marginBottom:"2.4rem",bgColor:"base",children:(0,t.jsx)(c.qE,{src:v||r.icon,w:"12.9rem",h:"12.9rem",onClick:function(){var e;null===(e=j.current)||void 0===e||e.click()}})})}),(0,t.jsx)(s.by,{onChange:y,ref:j,id:"icon",type:"file",accept:"image/*"}),(0,t.jsxs)(f.NI,{isInvalid:!!p.name,children:[(0,t.jsx)(f.lX,{htmlFor:"name",fontSize:"md",children:"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0"}),(0,t.jsx)(l.kC,{align:"center",justify:"center",children:(0,t.jsx)(m.II,F({variant:"filled",w:"34.4rem",h:"4.6rem",borderRightRadius:"10rem",borderLeftRadius:"10rem",bgColor:"white",filter:"drop-shadow(4px 4px 10px #E4EBEE)"},i("name")))}),(0,t.jsx)(f.J1,{children:p.name&&p.name.message})]}),(0,t.jsx)(u.zx,{position:"absolute",bottom:"12.9rem",right:"50%",transform:"translateX(50%)",disabled:b,variant:"round",onClick:h(g),children:"\u6c7a\u5b9a"})]})})},V=n(9033),q=(n(5828),n(9198)),M=n.n(q),$=n(944);(0,q.registerLocale)("ja",$.Z);var J=function(e){var r=e.name,n=e.control;return(0,t.jsx)(b.Qr,{control:n,name:r,render:function(e){var r=e.field,n=r.onChange,a=r.value,i=void 0===a?[null,null]:a;return(0,t.jsx)(M(),{locale:$.Z,selectsRange:!0,dateFormat:"yyyy/MM/dd",onChange:n,startDate:i[0],endDate:i[1],withPortal:!0})}})},K=n(3468),H=n(2770);function W(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function Q(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function G(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){Q(e,r,n[r])}))}return e}function Y(e){return function(e){if(Array.isArray(e))return W(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(!e)return;if("string"===typeof e)return W(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return W(e,r)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ee=function(e){var r=e.travelinkData,n=e.userData,i=e.isOwner,u=(0,a.useState)(!!r),c=u[0],h=u[1],y=function(e,r){var n=D((0,x.kt)(),2),t=n[0],i=n[1],o=(0,a.useState)(e?e.links.map((function(e){return e.category})):[]),l=o[0],u=o[1],c=(0,p.useRouter)(),s=c.query.traveliId,f=null===e||void 0===e?void 0:e.date.map((function(e){return e?e.toDate():null})),m=(0,b.cI)({resolver:(0,v.X)(P),defaultValues:R({},e,{date:f||[null,null]})}),d=m.register,h=m.control,y=m.handleSubmit,w=m.setValue,I=m.formState.errors,k=S(),C=k.uploadImage,O=k.imageFile,A=k.image,z=k.handleChangeImage,L=k.isImageChanged,N=j.h0,T=j.pz,Z=(0,b.Dq)({name:"links",control:h}),U=Z.fields,X=Z.append,B=Z.remove,F=function(){var r=E(g().mark((function r(n){var t,a,o;return g().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=n.links.map((function(e,r){return e.category=l[r],e})),a=R({},n,{links:t}),r.prev=2,i.on(),!O||!L){r.next=9;break}return r.next=7,C(O);case 7:o=r.sent,a.thumbnail=o;case 9:if(e){r.next=14;break}return r.next=12,_(a);case 12:r.next=16;break;case 14:return r.next=16,V(a,s);case 16:r.next=21;break;case 18:r.prev=18,r.t0=r.catch(2),console.error(r.t0);case 21:return r.prev=21,i.off(),r.finish(21);case 24:case"end":return r.stop()}}),r,null,[[2,18,21,24]])})));return function(e){return r.apply(this,arguments)}}(),_=function(){var e=E(g().mark((function e(n){var t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,N(R({},n,{ownerIcon:r.icon?r.icon:"",ownerName:r.name?r.name:""}),r.uid);case 4:t=e.sent,c.push("/".concat(t));case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),V=function(){var e=E(g().mark((function e(r,n){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(r,n);case 2:c.push("/".concat(n));case 3:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}();return{register:d,handleSubmit:y,fields:U,append:X,remove:B,control:h,onSubmit:F,errors:I,disabled:t,handleChangeImage:z,image:A,categories:l,setCategories:u,setValue:w}}(r,n),w=y.register,I=y.handleSubmit,k=y.fields,C=y.append,O=y.remove,A=y.control,z=y.onSubmit,L=y.errors,N=y.disabled,T=y.image,Z=y.handleChangeImage,U=y.setCategories,X=y.categories,B=y.setValue,F=function(){var e=(0,a.useRef)(null);return{inputRef:e,onClickImage:function(){var r;null===(r=e.current)||void 0===r||r.click()}}}(),_=F.inputRef,q=F.onClickImage,M=(0,p.useRouter)().query.traveliId;return(0,t.jsxs)(l.xu,{children:[(0,t.jsxs)(l.kC,{w:"100%",h:"6.3rem",justify:"center",align:"center",children:[(0,t.jsx)(o(),{href:r?"/".concat(M):"/home",children:(0,t.jsx)(l.rU,{children:(0,t.jsx)(d.BK,{bgColor:"none",w:"2.4rem",h:"2.4rem"})})}),(0,t.jsx)(l.LZ,{}),(0,t.jsx)(l.xu,{color:"black",fontSize:"md",fontWeight:"bold",children:"\u65b0\u3057\u3044\u30c8\u30e9\u30d9\u30ea\u30f3\u30af\u3092\u4f5c\u6210"}),(0,t.jsx)(l.LZ,{}),(0,t.jsx)(l.xu,{w:"2.2rem",h:"2.2rem"})]}),(0,t.jsxs)(f.NI,{isInvalid:!!L.title,children:[(0,t.jsx)(f.lX,{marginTop:"1.5rem",fontSize:"sm",color:"#2D2D2D",children:"\u65c5\u306e\u540d\u524d"}),(0,t.jsx)(m.II,G({variant:"filled",h:"4.6rem",marginTop:"0.8rem",borderRightRadius:"10rem",borderLeftRadius:"10rem",bgColor:"white",filter:"drop-shadow(0.4rem 0.4rem 1rem #E4EBEE)"},w("title"),{placeholder:"\u4f8b\uff09\u3068\u3082\u3060\u3061\u3068\u306e\u4e00\u6cca\u4e8c\u65e5\u306e\u65c5\u884c"})),(0,t.jsx)(f.J1,{children:L.title&&L.title.message})]}),(0,t.jsxs)(f.NI,{isInvalid:!!L.date,children:[(0,t.jsx)(f.lX,{marginTop:"1.6rem",fontSize:"sm",color:"#2D2D2D",children:"\u65e5\u6642\uff08\u4efb\u610f\uff09"}),(0,t.jsx)(J,{control:A,name:"date"})]}),(0,t.jsxs)(f.NI,{children:[(0,t.jsx)(f.lX,{marginTop:"1.6rem",fontSize:"sm",color:"#2D2D2D",children:"\u30b5\u30e0\u30cd\u30a4\u30eb\u753b\u50cf\uff08\u4efb\u610f\uff09"}),(0,t.jsx)(s.by,{ref:_,type:"file",accept:"image/*",onChange:Z}),(0,t.jsx)(l.xu,{marginTop:"0.8rem",bgImage:T||(r?r.thumbnail:""),bgRepeat:"no-repeat",bgSize:"cover",bgPosition:"center center",onClick:q,w:"100%",h:"12.9rem",borderRadius:"1rem",bgColor:"#D2D6E1",filter:"drop-shadow(0.4rem 0.4rem 1rem #E4EBEE)",children:(0,t.jsx)(l.kC,{h:"12.9rem",align:"center",justify:"center",children:(0,t.jsx)(d.Lj,{zIndex:1,w:"4.8rem",h:"4.8rem",color:"white"})})})]}),(0,t.jsx)(l.xu,{margin:"1.6rem 0 0.8rem 0",children:"\u30ea\u30f3\u30af"}),(0,t.jsxs)(f.NI,{children:[k.map((function(e,r){return(0,t.jsx)(a.Fragment,{children:(0,t.jsx)(K.ak,{categories:X,setCategories:U,label:e.label,url:e.url,index:r,register:w,errors:L.links,setValue:B,remove:function(){O(r)},isClickNext:c,setIsClickNext:h,isLast:k.length===r+1})},e.id)})),(0,t.jsxs)(l.kC,{align:"center",justify:"center",marginTop:"1.6rem",color:"brandBlue",children:[(0,t.jsx)(l.xu,{bgImage:"/images/plus.svg",w:"2.4rem",h:"2.4rem"}),(0,t.jsx)(l.xu,{as:"button",fontSize:"md",type:"button",onClick:function(){U((function(e){return Y(e).concat(["\u305d\u306e\u4ed6"])})),h(!0),C({url:"",label:""})},children:"\u30ea\u30b9\u30c8\u306e\u8ffd\u52a0"})]}),(i||!r)&&(0,t.jsxs)(f.NI,{display:"flex",alignItems:"center",paddingTop:"3rem",children:[(0,t.jsx)(V.r,G({sx:{"--switch-track-width":"3.8rem","--switch-track-height":"2rem"},backgroundColor:"#e3e4e5",borderRadius:"full",marginRight:"2.2rem",colorScheme:"brandBlue-switch"},w("canEdit"),{defaultChecked:null===r||void 0===r?void 0:r.canEdit})),(0,t.jsx)(f.lX,{children:"\u4ed6\u306e\u30e6\u30fc\u30b6\u306b\u7de8\u96c6\u3092\u8a31\u53ef\u3059\u308b"})]})]}),(0,t.jsx)(l.kC,{justify:"center",margin:"3rem 0 3.5rem 0",children:(0,t.jsx)(H.zx,{disabled:N,variant:"round",onClick:I(z),children:r?"\u5909\u66f4\u3059\u308b":"\u4f5c\u6210\u3059\u308b"})})]})}}}]);